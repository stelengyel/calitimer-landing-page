---
import '../styles/global.css';

interface Props {
  title?: string;
  description?: string;
  canonicalUrl?: string;
}

const {
  title = 'Get the CaliTimer app.',
  description = 'CaliTimer uses on-device computer vision to automatically detect and time calisthenics static skills. Hands-free. No tapping required. Join the waitlist.',
  canonicalUrl = Astro.url.href,
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#0C0906" />

    <!-- Primary meta -->
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalUrl} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content="/og-image.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="CaliTimer" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content="/og-image.png" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/app-icon-dark.png" />
    <link rel="apple-touch-icon" href="/app-icon-dark.png" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <!-- No tracking, analytics, or third-party scripts per PRD -->
  </head>
  <body>
    <slot />

    <!-- Success toast â€” shown by showToast() in EmailForm.astro after subscribe -->
    <div id="success-toast" aria-hidden="true">
      <svg width="18" height="18" viewBox="0 0 18 18" fill="none" aria-hidden="true" focusable="false">
        <circle cx="9" cy="9" r="8" stroke="#FF6B2B" stroke-width="1.5"/>
        <path d="M5.5 9.5l2.5 2.5 4.5-5" stroke="#FF6B2B" stroke-width="1.5"
          stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      You're on the list!
    </div>
  </body>
</html>

<style is:global>
  #success-toast {
    position: fixed;
    bottom: calc(28px + env(safe-area-inset-bottom, 0px));
    left: 50%;
    display: flex;
    align-items: center;
    gap: 10px;
    background: var(--surface-raised);
    border: 1px solid rgba(255, 107, 43, 0.25);
    border-radius: var(--radius-pill);
    padding: 13px 22px;
    font-family: var(--font-body);
    font-size: 15px;
    font-weight: 500;
    color: var(--text-primary);
    white-space: nowrap;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    pointer-events: none;
    z-index: 200;
    /* Start off-screen so it's invisible until triggered */
    transform: translateX(-50%) translateY(calc(100% + 48px));
    opacity: 0;
  }

  #success-toast.toast-in {
    animation: toast-up 0.4s cubic-bezier(0.34, 1.4, 0.64, 1) forwards;
  }

  #success-toast.toast-out {
    animation: toast-down 0.25s ease-in forwards;
  }

  @keyframes toast-up {
    from { transform: translateX(-50%) translateY(calc(100% + 48px)); opacity: 0; }
    to   { transform: translateX(-50%) translateY(0);                 opacity: 1; }
  }

  @keyframes toast-down {
    from { transform: translateX(-50%) translateY(0);                 opacity: 1; }
    to   { transform: translateX(-50%) translateY(calc(100% + 48px)); opacity: 0; }
  }
</style>
